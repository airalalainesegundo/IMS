{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-center mt-5">
  <div class="card p-4 w-75 shadow">
    <h3 class="text-center text-primary mb-3">ðŸŽ¥ Video Call with {{ student.name or student.username }}</h3>
    <div id="meet" style="height: 600px; border-radius: 12px; overflow: hidden;"></div>
  </div>
</div>

<script src="https://meet.jit.si/external_api.js"></script>
<script>
  const domain = "meet.jit.si";
  const roomName = "ims-video-call-{{ student.id }}";
  const options = {
    roomName: roomName,
    width: "100%",
    height: 600,
    parentNode: document.querySelector('#meet'),
    interfaceConfigOverwrite: {
      TOOLBAR_BUTTONS: [
        'microphone', 'camera', 'hangup', 'fullscreen', 'chat', 'raisehand'
      ]
    },
  };

  const api = new JitsiMeetExternalAPI(domain, options);

  // End call event
  api.addEventListener('readyToClose', () => {
    window.location.href = "{{ url_for('admin_dashboard') }}";
  });
</script>
{% endblock %}
